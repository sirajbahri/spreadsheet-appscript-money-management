<!DOCTYPE>
<html>
  <head>
    <base target="_top">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css" rel="stylesheet" />
    <style>
      .input-field { width: 100%; padding: 10px; margin: 5px 0; box-sizing: border-box; }
      .submit-button { width: 100%; padding: 10px; background-color: #FFD65A; color: white; border: none; border-radius: 5px; cursor: pointer; }
      .submit-button:hover { background-color: #ffdf7d; }
      .error { color: red; }
      .success { color: green; }
    </style>
  </head>
  <body>
    <form id="FormData">
      <!-- Jumlah -->
      <label for="jumlah">Jumlah:</label>
      <input type="number" id="jumlah" name="jumlah" class="input-field" placeholder="Masukkan jumlah"><br>

      <!-- Tanggal -->
      <label for="tanggal">Tanggal:</label>
      <input type="date" id="tanggal" name="tanggal" class="input-field"><br>

      <!-- Waktu -->
      <label for="waktu">Waktu:</label>
      <input type="time" id="waktu" name="waktu" class="input-field"><br>

      <!-- Tipe -->
      <label for="tipe">Tipe:</label>
      <div class="button-group">
        <button type="button" onclick="setTipe('Pengeluaran')">Pengeluaran</button>
        <button type="button" onclick="setTipe('Pemasukan')">Pemasukan</button>
      </div>
      <input type="hidden" id="tipe" name="tipe"><br>

      <!-- Kategori -->
      <label for="kategori">Kategori:</label>
      <select id="kategori" name="kategori" class="input-field"></select><br>

      <!-- Mode Pembayaran -->
      <label for="modePembayaran">Mode Pembayaran:</label>
      <select id="modePembayaran" name="modePembayaran" class="input-field">
        <option value="">Pilih Mode Pembayaran</option>
        <option value="Cash">Cash</option>
        <option value="Kartu Kredit">Kartu Kredit</option>
        <option value="Transfer Bank">Transfer Bank</option>
      </select><br>

      <!-- Pembayaran -->
      <label for="pembayaran">Pembayaran:</label>
      <select id="pembayaran" name="pembayaran" class="input-field">
        <option value="">Pilih Pembayaran</option>
        <option value="Mandiri">Mandiri</option>
        <option value="BCA">BCA</option>
        <option value="BRI">BRI</option>
        <option value="OVO">OVO</option>
        <option value="GoPay">GoPay</option>
      </select><br>

      <!-- Detail -->
      <label for="detail">Detail:</label>
      <textarea id="detail" name="detail" class="input-field"></textarea><br>

      <!-- Status -->
      <label for="status">Status:</label>
      <select id="status" name="status" class="input-field">
        <option value="">Pilih Status</option>
        <option value="Selesai">Selesai</option>
        <option value="Pending">Pending</option>
        <option value="Dibatalkan">Dibatalkan</option>
      </select><br>

      <!-- Bukti Pembayaran -->
      <label for="buktiPembayaran">Bukti Pembayaran:</label>
      <input type="file" name="buktiPembayaran"><br>



      <button type="button" class="submit-button" onclick="submitData()">Submit</button>
    </form>
    <div id="output"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.min.js"></script>
    <script>
      // Daftar kategori untuk Pengeluaran dan Pemasukan
      const kategoriPengeluaran = [
        { value: "Makanan", text: "Makanan" },
        { value: "Transportasi", text: "Transportasi" },
        { value: "Hiburan", text: "Hiburan" },
      ];
      const kategoriPemasukan = [
        { value: "Gaji", text: "Gaji" },
        { value: "Bonus", text: "Bonus" },
        { value: "Investasi", text: "Investasi" },
      ];

      // Inisialisasi Select2 pada dropdown
      $(document).ready(function () {
        $("#kategori").select2({ placeholder: "Pilih Kategori", allowClear: true });
        $("#modePembayaran").select2({ placeholder: "Pilih Mode Pembayaran", allowClear: true });
        $("#pembayaran").select2({ placeholder: "Pilih Pembayaran", allowClear: true });
      });

      // Set tipe dan kategori
      function setTipe(tipe) {
        document.getElementById("tipe").value = tipe;

        const kategoriDropdown = $("#kategori");
        kategoriDropdown.empty(); // Kosongkan opsi sebelumnya

        const kategoriList =
          tipe === "Pengeluaran" ? kategoriPengeluaran : kategoriPemasukan;

        kategoriList.forEach((kategori) => {
          const newOption = new Option(kategori.text, kategori.value);
          kategoriDropdown.append(newOption);
        });

        kategoriDropdown.val("").trigger("change");
      }

      // Submit data
      function submitData() {
        const jumlah = document.getElementById("jumlah").value;
        const tanggal = document.getElementById("tanggal").value;
        const waktu = document.getElementById("waktu").value;
        const tipe = document.getElementById("tipe").value;
        const kategori = document.getElementById("kategori").value;
        const modePembayaran = document.getElementById("modePembayaran").value;
        const pembayaran = document.getElementById("pembayaran").value;
        const detail = document.getElementById("detail").value;
        const status = document.getElementById("status").value;

        if (!jumlah || !tanggal || !waktu || !tipe || !kategori || !status) {
          document.getElementById("output").innerHTML = '<span class="error">Harap isi semua kolom wajib!</span>';
          return;
        }

        google.script.run
          .withSuccessHandler(() => {
            document.getElementById("FormData").reset();
            $("#kategori, #modePembayaran, #pembayaran").val("").trigger("change");
            document.getElementById("output").innerHTML = '<span class="success">Data berhasil disimpan.</span>';
          })
          .inputData(jumlah, tanggal, waktu, tipe, kategori, modePembayaran, pembayaran, detail, status);
      }
    </script>
  </body>
</html>
